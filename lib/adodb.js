!function(){"use strict";function e(a){WScript.StdOut.Write(encodeURI(JSON.stringify(a)))}function t(a){var e,f,g,h,b=[],c=a.Fields,d=c.Count;if(!a.BOF||!a.EOF)for(a.MoveFirst();!a.EOF;){for(f={},e=0;d>e;e++)h=(g=c.Item(e)).Value,7==g.type&&(h=new Date(Date.parse(h)||0).toJSON()+""),f[g.Name]=h;b.push(f),a.MoveNext()}return b}function n(a){for(var b={},c=a.Properties,d=c.Count,e=0;d>e;e++)prop=c.Item(e),b[prop.Name]={Type:prop.Type,Value:prop.Value};return b}function r(a){var c,d,e,f,b={};if(!a.BOF||!a.EOF)for(d=a.Fields,e=d.Count,f=0;e>f;f++)b[(c=d.Item(f)).Name]={Attributes:c.Attributes,DefinedSize:c.DefinedSize,NumericScale:c.NumericScale,Precision:c.Precision,Type:c.Type,Properties:n(c)};return b}function o(a){a.State&&a.Close()}"object"!=typeof JSON&&(JSON={}),function(){function e(a){return 10>a?"0"+a:a}function t(){return this.valueOf()}function n(a){return c.lastIndex=0,c.test(a)?'"'+a.replace(c,function(a){var b=l[a];return"string"==typeof b?b:"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+a+'"'}function r(a,b){var c,d,e,f,g,h=s,i=b[a];switch(i&&"object"==typeof i&&"function"==typeof i.toJSON&&(i=i.toJSON(a)),"function"==typeof y&&(i=y.call(b,a,i)),typeof i){case"string":return n(i);case"number":return isFinite(i)?String(i):"null";case"boolean":case"null":return String(i);case"object":if(!i)return"null";if(s+=p,g=[],"[object Array]"===Object.prototype.toString.apply(i)){for(f=i.length,c=0;f>c;c+=1)g[c]=r(c,i)||"null";return e=0===g.length?"[]":s?"[\n"+s+g.join(",\n"+s)+"\n"+h+"]":"["+g.join(",")+"]",s=h,e}if(y&&"object"==typeof y)for(f=y.length,c=0;f>c;c+=1)"string"==typeof y[c]&&(e=r(d=y[c],i))&&g.push(n(d)+(s?": ":":")+e);else for(d in i)Object.prototype.hasOwnProperty.call(i,d)&&(e=r(d,i))&&g.push(n(d)+(s?": ":":")+e);return e=0===g.length?"{}":s?"{\n"+s+g.join(",\n"+s)+"\n"+h+"}":"{"+g.join(",")+"}",s=h,e}}var s,p,l,y,o=/^[\],:{}\s]*$/,u=/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,i=/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,f=/(?:^|:|,)(?:\s*\[)+/g,c=/[\\"\u0000-\u001f\u007f-\u009f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,a=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g;"function"!=typeof Date.prototype.toJSON&&(Date.prototype.toJSON=function(){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+e(this.getUTCMonth()+1)+"-"+e(this.getUTCDate())+" "+e(this.getUTCHours())+":"+e(this.getUTCMinutes())+":"+e(this.getUTCSeconds()):null},Boolean.prototype.toJSON=t,Number.prototype.toJSON=t,String.prototype.toJSON=t),"function"!=typeof JSON.stringify&&(l={"\b":"\\b","	":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},JSON.stringify=function(a,b,c){var d;if(s="",p="","number"==typeof c)for(d=0;c>d;d+=1)p+=" ";else"string"==typeof c&&(p=c);if(y=b,b&&"function"!=typeof b&&("object"!=typeof b||"number"!=typeof b.length))throw new Error("JSON.stringify");return r("",{"":a})}),"function"!=typeof JSON.parse&&(JSON.parse=function(e,t){function n(a,b){var c,d,e=a[b];if(e&&"object"==typeof e)for(c in e)Object.prototype.hasOwnProperty.call(e,c)&&(void 0!==(d=n(e,c))?e[c]=d:delete e[c]);return t.call(a,b,e)}var r;if(e=String(e),a.lastIndex=0,a.test(e)&&(e=e.replace(a,function(a){return"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})),o.test(e.replace(u,"@").replace(i,"]").replace(f,"")))return r=eval("("+e+")"),"function"==typeof t?n({"":r},""):r;throw new SyntaxError("JSON.parse")})}();var u={execute:function(a){var b,c={valid:!0},d=!!a.scalar,f=new ActiveXObject("ADODB.Connection");d&&(b=new ActiveXObject("ADODB.Recordset")),f.CursorLocation=3;try{f.Open(a.connection),f.Execute(a.sql),d&&(b.Open(a.scalar,f,0,1),c.records=t(b))}catch(g){c.valid=!1,c.message=g.message}e(c),o(f),d&&o(b)},query:function(a){var b=!!a.schema,c=new ActiveXObject("ADODB.Connection"),d=new ActiveXObject("ADODB.Recordset"),f={valid:!0};c.CursorLocation=3;try{c.Open(a.connection),d.Open(a.sql,c,0,1),f.records=t(d),b&&(f.schema=r(d))}catch(g){f.valid=!1,f.message=g.message}e(f),r(d),o(c)}};try{u[WScript.Arguments(0)](JSON.parse(decodeURI(WScript.Arguments(1))))}catch(i){e({valid:!1,message:i.message})}}();
